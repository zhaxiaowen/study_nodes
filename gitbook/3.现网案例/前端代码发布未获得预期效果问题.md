### 遇到的故障

#### 1.问题现象:

* 安排晚上上线,研发最后再uat1环境测试,反馈uat1环境前端代码发布后,页面没有预期改变,怀疑jenkins有问题

#### 2.定位过程

1. 查看jenkins日志,发现一切正常
2. 登录ansible服务器,查看拉下来的代码包,git分支,以及版本号等,确认无误,反馈给研发,然后建议研发新增一个test文件,我重新发包
3. 新增test文件后,重新发包,test文件已发布,确认发布无误,研发坚持还是发包有问题
4. 找研发要了他新增的详细代码,去到ansible服务器上查到对应的代码,反馈给研发
5. 研发去dev环境验证,并说明dev1和uat1代码一样,但效果不一样,明确他那边没问题
6. 我让研发修改其他正常页面,如果有改变,说明他代码问题,如果没改变,说明不是代码问题
7. 修改正常页面后,还是没效果,我才认真考虑起这个问题
8. 查看cmdb前端配置,发现nginx配置都没点生成,一下明确,大概是运维侧的问题
9. 点击生成nginx配置后,再检查nginx配置,发现一切正常,再次发包,发现还是未生效
10. ping请求域名,发现域名的nginx地址与cmdb上生成的nginx地址不同
11. 将cmdb上该服务的前端地址绑定到与域名一致的服务器
12. 再次发包,前端界面显示预期结果

#### 3.问题原因

* 周一做了fat4和uat1环境的nginx迁移,将公司内部服务的域名全部部署到一台app服务器上,对外的域名,全部部署在一台nginx服务器上,配置文件都做了迁移,但是对应服务绑定的服务器没有修改
* 原nginx服务器上的前端代码都没有删除,所以正常的访问是可以,但是发布代码没效果

#### 4.导致后果

* 导致预计晚上发布的版本,没能发布,推迟一天

#### 5.思考

1. 本次问题定位,从一开始就被研发带偏,忽略了实际问题,耗费过多时间与研发争论jenkins发布是否正常
2. 到后面,其实已经觉得研发有点无理取闹,一直坚持定位问题的原因,是我自己想说服对方是他的错误
3. 反思一下,从个人性格来说,过程中有点急躁,后来就没有真心实意的去想着帮对方解决问题
4. 反思二下,忽略了对方的实际诉求是代码没生效,但是却把主焦点放在了jenkins上



#### 

#### 1.问题现象:

* 背景:前端要求配置多个二级目录,已访问不同前端项目;前端目录为:一个main目录为/目录,其他项目放在与main同级的sub目录下,各自一个子目录
* nginx配置完成后,请求对应url,页面显示空白,查看nginx日志访问正常,F12,发现js请求一片红,js路径配置错误
* 前端修改代码后,继续请求,请求成功,但是刷新页面后,页面报404
* 查看nginx日志,报alias没权限rewrite...

#### 2.问题原因

* rewrite语法的url后,写的是break,改成last后,可以正常请求

